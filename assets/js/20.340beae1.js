(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{462:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("ref: "),t("a",{attrs:{href:"https://www.pytorchtutorial.com/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("PyTorchä¸­æ–‡æ–‡æ¡£"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("PyTorch æ˜¯æ˜¯åŸºäºä»¥ä¸‹ä¸¤ä¸ªç›®çš„è€Œæ‰“é€ çš„pythonç§‘å­¦è®¡ç®—æ¡†æ¶ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("æ— ç¼æ›¿æ¢NumPyï¼Œåˆ©ç”¨GPUçš„ç®—åŠ›æ¥åŠ é€Ÿç¥ç»ç½‘ç»œï¼ˆcudaï¼‰")])]),s._v(" "),t("li",[t("p",[s._v("é€šè¿‡è‡ªåŠ¨æ±‚å¯¼æœºåˆ¶ï¼Œæ¥è®©ç¥ç»ç½‘ç»œçš„å®ç°å˜å¾—æ›´åŠ å®¹æ˜“")])])])]),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"å¼ é‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¼ é‡"}},[s._v("#")]),s._v(" å¼ é‡")]),s._v(" "),t("p",[s._v("tensor")]),s._v(" "),t("h3",{attrs:{id:"åˆå§‹åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–"}},[s._v("#")]),s._v(" åˆå§‹åŒ–")]),s._v(" "),t("ul",[t("li",[s._v("ç›´æ¥ç”Ÿæˆå¼ é‡")])]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nx_data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[1, 2],\n        [3, 4]])\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("é€šè¿‡numpyæ•°ç»„ç”Ÿæˆ")])]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" numpy "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" np\n\nnp_array "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("array"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nx_np "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("from_numpy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("np_array"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x_np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[1, 2],\n        [3, 4]])\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("ul",[t("li",[s._v("é€šè¿‡å·²æœ‰çš„å¼ é‡æ¥ç”Ÿæˆæ–°çš„å¼ é‡")])]),s._v(" "),t("p",[s._v("ç»§æ‰¿å·²æœ‰å¼ é‡çš„æ•°æ®å±æ€§ï¼ˆç»“æ„ã€ç±»å‹ï¼‰ï¼Œä¹Ÿå¯ä»¥é‡å†™æ–°ç±»å‹")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("x_ones "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ones_like"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¿ç•™ x_data çš„å±æ€§")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"Ones Tensor: \\n ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("x_ones"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v(' \\n"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nx_rand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rand_like"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dtype"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("float")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é‡å†™ x_data çš„æ•°æ®ç±»å‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"Random Tensor: \\n ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("x_rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v(' \\n"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nOnes Tensor: \n tensor([[1, 1],\n        [1, 1]]) \n\nRandom Tensor: \n tensor([[0.2622, 0.2768],\n        [0.2162, 0.0212]]) \n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("ul",[t("li",[s._v("é€šè¿‡æŒ‡å®šæ•°æ®ç»´åº¦æ¥ç”Ÿæˆå¼ é‡")])]),s._v(" "),t("p",[s._v("shapeæ˜¯å…ƒç»„ç±»å‹, ç”¨æ¥æè¿°å¼ é‡çš„ç»´æ•°, ä¸‹é¢3ä¸ªå‡½æ•°é€šè¿‡ä¼ å…¥shapeæ¥æŒ‡å®šç”Ÿæˆå¼ é‡çš„ç»´æ•°ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("shape "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrand_tensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shape"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nones_tensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ones"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shape"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nzeros_tensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zeros"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shape"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"Random Tensor: \\n ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("rand_tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v(' \\n"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"Ones Tensor: \\n ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ones_tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v(' \\n"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"Zeros Tensor: \\n ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("zeros_tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nRandom Tensor: \n tensor([[0.7244, 0.3744, 0.9196],\n        [0.5778, 0.4171, 0.0868]]) \n\nOnes Tensor: \n tensor([[1., 1., 1.],\n        [1., 1., 1.]]) \n\nZeros Tensor: \n tensor([[0., 0., 0.],\n        [0., 0., 0.]])\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h3",{attrs:{id:"å±æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å±æ€§"}},[s._v("#")]),s._v(" å±æ€§")]),s._v(" "),t("ul",[t("li",[s._v("ç»´æ•°ï¼šshape")]),s._v(" "),t("li",[s._v("æ•°æ®ç±»å‹ï¼šdtype")]),s._v(" "),t("li",[s._v("æ‰€å­˜å‚¨çš„è®¾å¤‡(CPUæˆ–GPU)ï¼šdevice")])]),s._v(" "),t("h3",{attrs:{id:"è¿ç®—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è¿ç®—"}},[s._v("#")]),s._v(" è¿ç®—")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ¤æ–­å½“å‰ç¯å¢ƒGPUæ˜¯å¦å¯ç”¨, ç„¶åå°†tensorå¯¼å…¥GPUå†…è¿è¡Œ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cuda"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_available"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    tensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cuda'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"ç´¢å¼•å’Œåˆ‡ç‰‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç´¢å¼•å’Œåˆ‡ç‰‡"}},[s._v("#")]),s._v(" ç´¢å¼•å’Œåˆ‡ç‰‡")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("tensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ones"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°†ç¬¬1åˆ—(ä»0å¼€å§‹)çš„æ•°æ®å…¨éƒ¨èµ‹å€¼ä¸º0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[1., 0., 1., 1.],\n        [1., 0., 1., 1.],\n        [1., 0., 1., 1.],\n        [1., 0., 1., 1.]], dtype=torch.int32)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"æ‹¼æ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ‹¼æ¥"}},[s._v("#")]),s._v(" æ‹¼æ¥")]),s._v(" "),t("p",[s._v("torch.cat æˆ– torch.stackï¼Œdimä¸ºæ‹¼æ¥æ–¹å‘çš„ç»´åº¦")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("t1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dim"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0:è¡Œ 1ï¼šåˆ—")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],\n        [1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],\n        [1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],\n        [1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1]], dtype=torch.int32)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"å¼ é‡ä¹˜ç§¯å’ŒçŸ©é˜µä¹˜æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¼ é‡ä¹˜ç§¯å’ŒçŸ©é˜µä¹˜æ³•"}},[s._v("#")]),s._v(" å¼ é‡ä¹˜ç§¯å’ŒçŸ©é˜µä¹˜æ³•")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é€ä¸ªç›¸ä¹˜ï¼ŒäºŒè€…ç­‰ä»·")]),s._v("\ntensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mul"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntensor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" tensor\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# çŸ©é˜µä¹˜æ³•ï¼ŒäºŒè€…ç­‰ä»·")]),s._v("\ntensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("matmul"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("T"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntensor @ tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("T\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"è‡ªåŠ¨èµ‹å€¼è¿ç®—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªåŠ¨èµ‹å€¼è¿ç®—"}},[s._v("#")]),s._v(" è‡ªåŠ¨èµ‹å€¼è¿ç®—")]),s._v(" "),t("p",[s._v("è‡ªåŠ¨èµ‹å€¼è¿ç®—é€šå¸¸åœ¨æ–¹æ³•åæœ‰ _ ä½œä¸ºåç¼€ï¼Œä¾‹å¦‚: x.copy_(y), x.t_()æ“ä½œä¼šæ”¹å˜ x çš„å–å€¼ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add_"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[6, 5, 6, 6],\n        [6, 5, 6, 6],\n        [6, 5, 6, 6],\n        [6, 5, 6, 6]], dtype=torch.int32)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("blockquote",[t("p",[s._v("è‡ªåŠ¨èµ‹å€¼è¿ç®—è™½ç„¶å¯ä»¥èŠ‚çœå†…å­˜, ä½†åœ¨æ±‚å¯¼æ—¶ä¼šå› ä¸ºä¸¢å¤±äº†ä¸­é—´è¿‡ç¨‹è€Œå¯¼è‡´ä¸€äº›é—®é¢˜, æ‰€ä»¥æˆ‘ä»¬å¹¶ä¸é¼“åŠ±ä½¿ç”¨å®ƒã€‚")])]),s._v(" "),t("h2",{attrs:{id:"autograd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#autograd"}},[s._v("#")]),s._v(" Autograd")]),s._v(" "),t("p",[t("code",[s._v("torch.autograd")]),s._v("æ˜¯ PyTorch çš„è‡ªåŠ¨å·®åˆ†å¼•æ“ï¼Œå¯ä¸ºç¥ç»ç½‘ç»œè®­ç»ƒæä¾›æ”¯æŒã€‚")]),s._v(" "),t("h3",{attrs:{id:"ex-ä¸€ä¸ªè®­ç»ƒæ­¥éª¤ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ex-ä¸€ä¸ªè®­ç»ƒæ­¥éª¤ç¤ºä¾‹"}},[s._v("#")]),s._v(" exï¼šä¸€ä¸ªè®­ç»ƒæ­¥éª¤ç¤ºä¾‹")]),s._v(" "),t("p",[s._v("ä»"),t("code",[s._v("torchvision")]),s._v("åŠ è½½äº†ç»è¿‡é¢„è®­ç»ƒçš„"),t("code",[s._v("resnet18")]),s._v("æ¨¡å‹ã€‚ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéšæœºæ•°æ®å¼ é‡æ¥è¡¨ç¤ºå…·æœ‰ 3 ä¸ªé€šé“çš„å•ä¸ªå›¾åƒï¼Œé«˜åº¦&å®½åº¦ä¸º 64ï¼Œå…¶å¯¹åº”çš„labelåˆå§‹åŒ–ä¸ºä¸€äº›éšæœºå€¼ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" torchvision\nmodel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torchvision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resnet18"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pretrained"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndata "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlabels "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("æ­£å‘ä¼ æ’­:")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("prediction "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# forward pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("åå‘ä¼ æ’­ï¼Œ"),t("code",[s._v("Autograd")]),s._v(" ä¼šä¸ºæ¯ä¸ªæ¨¡å‹å‚æ•°è®¡ç®—æ¢¯åº¦å¹¶å°†å…¶å­˜å‚¨åœ¨å‚æ•°çš„"),t("code",[s._v(".grad")]),s._v("å±æ€§ä¸­ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("loss "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prediction "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" labels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nloss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backward"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# backward pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åŠ è½½ä¸€ä¸ªä¼˜åŒ–å™¨ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ï¼Œå­¦ä¹ ç‡ä¸º 0.01ï¼ŒåŠ¨é‡ä¸º 0.9ã€‚ æˆ‘ä»¬åœ¨ä¼˜åŒ–å™¨ä¸­æ³¨å†Œæ¨¡å‹çš„æ‰€æœ‰å‚æ•°ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("optimizer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("optim"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SGD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e-2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" momentum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("è°ƒç”¨"),t("code",[s._v(".step()")]),s._v("å¯åŠ¨æ¢¯åº¦ä¸‹é™ã€‚ ä¼˜åŒ–å™¨é€šè¿‡"),t("code",[s._v(".grad")]),s._v("ä¸­å­˜å‚¨çš„æ¢¯åº¦æ¥è°ƒæ•´æ¯ä¸ªå‚æ•°ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("optimizer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("step"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gradient descent")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"ex-autogradå¦‚ä½•æ”¶é›†æ¢¯åº¦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ex-autogradå¦‚ä½•æ”¶é›†æ¢¯åº¦"}},[s._v("#")]),s._v(" exï¼šAutogradå¦‚ä½•æ”¶é›†æ¢¯åº¦")]),s._v(" "),t("p",[s._v("é¦–å…ˆç”¨"),t("code",[s._v("requires_grad=True")]),s._v("åˆ›å»ºä¸¤ä¸ªå¼ é‡"),t("code",[s._v("a")]),s._v("å’Œ"),t("code",[s._v("b")]),s._v("ã€‚ è¿™å‘autogradå‘å‡ºä¿¡å·ï¼Œåº”è·Ÿè¸ªå¯¹å®ƒä»¬çš„æ‰€æœ‰æ“ä½œã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" requires_grad"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" requires_grad"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("ä»aå’Œbåˆ›å»ºå¦ä¸€ä¸ªå¼ é‡"),t("code",[s._v("Q")]),s._v("ã€‚å‡è®¾"),t("code",[s._v("a")]),s._v("å’Œ"),t("code",[s._v("b")]),s._v("æ˜¯å‚æ•°ï¼Œ"),t("code",[s._v("Q")]),s._v("æ˜¯è¯¯å·®ï¼Œåœ¨"),t("code",[s._v("Q")]),s._v("ä¸Šè°ƒç”¨"),t("code",[s._v(".backward()")]),s._v("æ—¶ï¼Œ"),t("code",[s._v("Autograd")]),s._v(" å°†è®¡ç®—è¿™äº›æ¢¯åº¦å¹¶å°†å…¶å­˜å‚¨åœ¨å„ä¸ªå¼ é‡çš„"),t("code",[s._v(".grad")]),s._v("å±æ€§ä¸­ã€‚")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬éœ€è¦åœ¨"),t("code",[s._v("Q.backward()")]),s._v("ä¸­æ˜¾å¼ä¼ é€’"),t("code",[s._v("gradient")]),s._v("å‚æ•°ï¼Œå› ä¸ºå®ƒæ˜¯å‘é‡ã€‚ "),t("code",[s._v("gradient")]),s._v("æ˜¯ä¸"),t("code",[s._v("Q")]),s._v("å½¢çŠ¶ç›¸åŒçš„å¼ é‡ï¼Œå®ƒè¡¨ç¤ºQç›¸å¯¹äºæœ¬èº«çš„æ¢¯åº¦ï¼Œå³\nğŸ™\nï¼›åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†"),t("code",[s._v("Q")]),s._v("èšåˆä¸ºä¸€ä¸ªæ ‡é‡ï¼Œç„¶åéšå¼åœ°å‘åè°ƒç”¨ï¼Œä¾‹å¦‚"),t("code",[s._v("Q.sum().backward()")]),s._v("ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("Q "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3a^3-b^2")]),s._v("\nexternal_grad "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tensor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nQ"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backward"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gradient"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("external_grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Qæ˜¯å¼ é‡")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç»“æœéƒ½æ˜¯true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"è®¡ç®—å›¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è®¡ç®—å›¾"}},[s._v("#")]),s._v(" è®¡ç®—å›¾")]),s._v(" "),t("p",[t("code",[s._v("Autograd")]),s._v(" åœ¨ç”±å‡½æ•°å¯¹è±¡ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼ˆ"),t("code",[s._v("DAG")]),s._v("ï¼‰ä¸­è®°å½•æ•°æ®ï¼ˆå¼ é‡ï¼‰å’Œæ‰€æœ‰å·²æ‰§è¡Œçš„æ“ä½œï¼ˆä»¥åŠç”±æ­¤äº§ç”Ÿçš„æ–°å¼ é‡ï¼‰ã€‚ åœ¨æ­¤"),t("code",[s._v("DAG")]),s._v("ä¸­ï¼Œå¶å­æ˜¯è¾“å…¥å¼ é‡ï¼Œæ ¹æ˜¯è¾“å‡ºå¼ é‡ã€‚ é€šè¿‡ä»æ ¹åˆ°å¶è·Ÿè¸ªæ­¤å›¾ï¼Œå¯ä»¥ä½¿ç”¨é“¾å¼è§„åˆ™è‡ªåŠ¨è®¡ç®—æ¢¯åº¦ã€‚")]),s._v(" "),t("p",[s._v("åœ¨æ­£å‘ä¼ æ’­ä¸­ï¼Œ"),t("code",[s._v("Autograd")]),s._v(" åŒæ—¶æ‰§è¡Œä¸¤é¡¹æ“ä½œï¼š")]),s._v(" "),t("ul",[t("li",[s._v("è¿è¡Œè¯·æ±‚çš„æ“ä½œä»¥è®¡ç®—ç»“æœå¼ é‡")]),s._v(" "),t("li",[s._v("åœ¨ DAG ä¸­ç»´æŠ¤æ“ä½œçš„æ¢¯åº¦å‡½æ•°")])]),s._v(" "),t("p",[s._v("å½“åœ¨"),t("code",[s._v("DAG")]),s._v("æ ¹ç›®å½•ä¸Šè°ƒç”¨"),t("code",[s._v(".backward()")]),s._v("æ—¶ï¼Œåå‘ä¼ é€’å¼€å§‹ã€‚"),t("code",[s._v("Autograd")]),s._v("æ‰§è¡Œï¼š")]),s._v(" "),t("p",[s._v("ä»æ¯ä¸ª"),t("code",[s._v(".grad_fn")]),s._v("è®¡ç®—æ¢¯åº¦ï¼Œå°†å®ƒä»¬ç´¯ç§¯åœ¨å„è‡ªçš„å¼ é‡çš„"),t("code",[s._v(".grad")]),s._v("å±æ€§ä¸­\nä½¿ç”¨é“¾å¼è§„åˆ™ä¸€ç›´ä¼ æ’­åˆ°å¶å­å¼ é‡\n"),t("code",[s._v("DAG")]),s._v(" åœ¨ "),t("code",[s._v("PyTorch")]),s._v(" ä¸­æ˜¯åŠ¨æ€çš„ã€‚è¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œå›¾æ˜¯ä»å¤´å¼€å§‹é‡æ–°åˆ›å»ºçš„ï¼› åœ¨æ¯ä¸ª"),t("code",[s._v(".backward()")]),s._v("è°ƒç”¨ä¹‹åï¼Œ"),t("code",[s._v("Autograd")]),s._v(" å¼€å§‹å¡«å……æ–°å›¾ã€‚ å¯ä»¥æ ¹æ®éœ€è¦åœ¨æ¯æ¬¡è¿­ä»£ä¸­æ›´æ”¹å½¢çŠ¶ï¼Œå¤§å°å’Œæ“ä½œã€‚")]),s._v(" "),t("h3",{attrs:{id:"ä»dagä¸­æ’é™¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»dagä¸­æ’é™¤"}},[s._v("#")]),s._v(" ä»DAGä¸­æ’é™¤")]),s._v(" "),t("p",[s._v("å¯¹äºä¸éœ€è¦æ¢¯åº¦çš„å¼ é‡ï¼Œå°†"),t("code",[s._v("requires_grad")]),s._v("å±æ€§è®¾ç½®ä¸º"),t("code",[s._v("False")]),s._v("ä¼šå°†å…¶ä»æ¢¯åº¦è®¡ç®— "),t("code",[s._v("DAG")]),s._v(" ä¸­æ’é™¤ã€‚ä½†æ³¨æ„ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªè¾“å…¥å¼ é‡è¯¥å±æ€§ä¸º"),t("code",[s._v("True")]),s._v("ï¼Œæ“ä½œçš„è¾“å‡ºå¼ é‡ä¹Ÿå°†éœ€è¦æ¢¯åº¦ã€‚")]),s._v(" "),t("p",[s._v("åœ¨"),t("code",[s._v("NN")]),s._v("ä¸­ï¼Œä¸è®¡ç®—æ¢¯åº¦çš„å‚æ•°é€šå¸¸ç§°ä¸ºå†»ç»“å‚æ•°ã€‚ å¦‚æœäº‹å…ˆçŸ¥é“æ‚¨ä¸éœ€è¦è¿™äº›å‚æ•°çš„æ¢¯åº¦ï¼Œåˆ™â€œå†»ç»“â€æ¨¡å‹çš„ä¸€éƒ¨åˆ†ä¼šå¸¦æ¥æ€§èƒ½ä¼˜åŠ¿ã€‚å¸¸è§ç”¨ä¾‹ï¼šè°ƒæ•´é¢„è®­ç»ƒç½‘ç»œ(finetuning)")]),s._v(" "),t("p",[s._v("åœ¨å¾®è°ƒä¸­ï¼Œæˆ‘ä»¬å†»ç»“äº†å¤§éƒ¨åˆ†æ¨¡å‹ï¼Œé€šå¸¸ä»…ä¿®æ”¹åˆ†ç±»å™¨å±‚ä»¥å¯¹æ–°æ ‡ç­¾è¿›è¡Œé¢„æµ‹ã€‚ exï¼šåŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒçš„ resnet18 æ¨¡å‹ï¼Œå¹¶å†»ç»“æ‰€æœ‰å‚æ•°ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" torch "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optim\n\nmodel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torchvision"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resnet18"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pretrained"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Freeze all the parameters in the network")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" param "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    param"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("requires_grad "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("å‡è®¾æˆ‘ä»¬è¦åœ¨å…·æœ‰ 10 ä¸ªæ ‡ç­¾çš„æ–°æ•°æ®é›†ä¸­å¾®è°ƒæ¨¡å‹ã€‚ åœ¨"),t("code",[s._v("resnet")]),s._v(" ä¸­ï¼Œåˆ†ç±»å™¨æ˜¯æœ€åä¸€ä¸ªçº¿æ€§å±‚"),t("code",[s._v("model.fc")]),s._v("ã€‚ æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å…¶æ›¿æ¢ä¸ºå……å½“æˆ‘ä»¬çš„åˆ†ç±»å™¨çš„æ–°çº¿æ€§å±‚ï¼ˆé»˜è®¤æƒ…å†µä¸‹æœªå†»ç»“ï¼‰ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ç°åœ¨ï¼Œé™¤äº†"),t("code",[s._v("model.fc")]),s._v("çš„å‚æ•°å¤–ï¼Œæ¨¡å‹ä¸­çš„æ‰€æœ‰å‚æ•°éƒ½å°†å†»ç»“ã€‚ è®¡ç®—æ¢¯åº¦çš„å”¯ä¸€å‚æ•°æ˜¯"),t("code",[s._v("model.fc")]),s._v("çš„æƒé‡å’Œåå·®ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optimize only the classifier")]),s._v("\noptimizer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" optim"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SGD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1e-2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" momentum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("å°½ç®¡æˆ‘ä»¬åœ¨ä¼˜åŒ–å™¨ä¸­æ³¨å†Œäº†æ‰€æœ‰å‚æ•°ï¼Œä½†å”¯ä¸€å¯è®¡ç®—æ¢¯åº¦çš„å‚æ•°ï¼ˆå› æ­¤ä¼šåœ¨æ¢¯åº¦ä¸‹é™ä¸­è¿›è¡Œæ›´æ–°ï¼‰æ˜¯åˆ†ç±»å™¨çš„æƒé‡å’Œåå·®ã€‚")]),s._v(" "),t("p",[t("code",[s._v("torch.no_grad()")]),s._v("ä¸­çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ’é™¤åŠŸèƒ½ã€‚")]),s._v(" "),t("h2",{attrs:{id:"ç¥ç»ç½‘ç»œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¥ç»ç½‘ç»œ"}},[s._v("#")]),s._v(" ç¥ç»ç½‘ç»œ")]),s._v(" "),t("p",[s._v("å¯ä»¥ä½¿ç”¨"),t("code",[s._v("torch.nn")]),s._v("åŒ…æ„å»ºç¥ç»ç½‘ç»œã€‚"),t("code",[s._v("nn")]),s._v("ä¾èµ–äº"),t("code",[s._v("autograd")]),s._v("æ¥å®šä¹‰æ¨¡å‹å¹¶å¯¹å…¶è¿›è¡Œå¾®åˆ†ã€‚")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å®šä¹‰ç½‘ç»œæ—¶ï¼Œéœ€è¦ç»§æ‰¿"),t("code",[s._v("nn.Module")]),s._v("ï¼Œå¹¶å®ç°å®ƒçš„"),t("code",[s._v("forward")]),s._v("æ–¹æ³•ï¼ŒæŠŠç½‘ç»œä¸­å…·æœ‰å¯å­¦ä¹ å‚æ•°çš„å±‚æ”¾åœ¨æ„é€ å‡½æ•°"),t("code",[s._v("__init__")]),s._v("ä¸­ã€‚")])]),s._v(" "),t("li",[t("p",[s._v("åªè¦åœ¨"),t("code",[s._v("nn.Module")]),s._v("çš„å­ç±»ä¸­å®šä¹‰äº†"),t("code",[s._v("forward")]),s._v("å‡½æ•°ï¼Œ"),t("code",[s._v("backward")]),s._v("å‡½æ•°å°±ä¼šè‡ªåŠ¨è¢«å®ç°(åˆ©ç”¨"),t("code",[s._v("autograd")]),s._v(")ã€‚")])])]),s._v(" "),t("p",[s._v("ç¥ç»ç½‘ç»œçš„å…¸å‹è®­ç»ƒè¿‡ç¨‹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å®šä¹‰å…·æœ‰ä¸€äº›å¯å­¦ä¹ å‚æ•°ï¼ˆæˆ–æƒé‡ï¼‰çš„ç¥ç»ç½‘ç»œ")]),s._v(" "),t("li",[s._v("éå†è¾“å…¥æ•°æ®é›†")]),s._v(" "),t("li",[s._v("é€šè¿‡ç½‘ç»œå¤„ç†è¾“å…¥")]),s._v(" "),t("li",[s._v("è®¡ç®—æŸå¤±ï¼ˆè¾“å‡ºæ­£ç¡®çš„è·ç¦»æœ‰å¤šè¿œï¼‰")]),s._v(" "),t("li",[s._v("å°†æ¢¯åº¦ä¼ æ’­å›ç½‘ç»œå‚æ•°")]),s._v(" "),t("li",[s._v("é€šå¸¸ä½¿ç”¨ç®€å•çš„æ›´æ–°è§„åˆ™æ¥æ›´æ–°ç½‘ç»œçš„æƒé‡ï¼š"),t("code",[s._v("weight")]),s._v(" = "),t("code",[s._v("weight")]),s._v(" - "),t("code",[s._v("learning_rate")]),s._v(" * "),t("code",[s._v("gradient")])])]),s._v(" "),t("h3",{attrs:{id:"åˆ›å»ºç½‘ç»œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºç½‘ç»œ"}},[s._v("#")]),s._v(" åˆ›å»ºç½‘ç»œ")]),s._v(" "),t("p",[s._v("ex: åˆ©ç”¨MNISTæ•°æ®é›†è¯†åˆ«æ‰‹å†™æ•°å­—")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" nn\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("functional "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" F\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Net")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("super")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("__init__"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 input image channel, 6 output channels, 5x5 square convolution kernel")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Conv2d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Conv2d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# an affine operation: y = Wx + b")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5*5 from image dimension")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Linear"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŒ‡å®šç½‘ç»œçš„è¿è¡Œè¿‡ç¨‹")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forward")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Max pooling over a (2, 2) window")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("max_pool2d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If the size is a square, you can specify with a single number")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("max_pool2d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# flatten all dimensions except the batch dimension æ‹‰å¹³x")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fc3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" x\n\n\nnet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nNet(\n  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))\n  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n  (fc1): Linear(in_features=400, out_features=120, bias=True)\n  (fc2): Linear(in_features=120, out_features=84, bias=True)\n  (fc3): Linear(in_features=84, out_features=10, bias=True)\n)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("p",[s._v("æ¨¡å‹çš„å¯å­¦ä¹ å‚æ•°ç”±net.parameters()è¿”å›ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("params "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fowardå‡½æ•°åŒ…å«10ä¸ªæ“ä½œ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\n10\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("å°è¯•ä¸€ä¸ª 32*32 éšæœºè¾“å…¥ã€‚")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nout "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor([[ 0.0818, -0.0857,  0.0695,  0.1430,  0.0191, -0.1402,  0.0499, -0.0737,\n         -0.0857,  0.1395]], grad_fn=<AddmmBackward0>)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("ä½¿ç”¨éšæœºæ¢¯åº¦å°†æ‰€æœ‰å‚æ•°å’Œåå‘ä¼ æ’­çš„æ¢¯åº¦ç¼“å†²åŒºå½’é›¶ï¼š")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zero_grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nout"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backward"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("æ³¨æ„ï¼š"),t("code",[s._v("torch.nn")]),s._v("ä»…æ”¯æŒ"),t("code",[s._v("mini-batch")]),s._v("ã€‚ æ•´ä¸ª"),t("code",[s._v("torch.nn")]),s._v("åŒ…ä»…æ”¯æŒä½œä¸ºå¾®å‹æ ·æœ¬è€Œä¸æ˜¯å•ä¸ªæ ·æœ¬çš„è¾“å…¥ï¼šexï¼š"),t("code",[s._v("nn.Conv2d")]),s._v("å°†é‡‡ç”¨"),t("code",[s._v("nSamples")]),s._v(" x "),t("code",[s._v("nChannels")]),s._v(" x "),t("code",[s._v("Height")]),s._v(" x "),t("code",[s._v("Width")]),s._v("çš„ 4D å¼ é‡ã€‚å¦‚æœæ‚¨åªæœ‰ä¸€ä¸ªæ ·æœ¬ï¼Œåªéœ€ä½¿ç”¨"),t("code",[s._v("input.unsqueeze(0)")]),s._v("æ·»åŠ ä¸€ä¸ªå‡æ‰¹é‡å°ºå¯¸ã€‚")])]),s._v(" "),t("p",[s._v("æ€»ç»“ï¼š")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("torch.Tensor")]),s._v(": ä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œæ”¯æŒè¯¸å¦‚"),t("code",[s._v("backward()")]),s._v("çš„è‡ªåŠ¨å¾®åˆ†æ“ä½œã€‚ åŒæ ·ï¼Œä¿æŒç›¸å¯¹äºå¼ é‡çš„æ¢¯åº¦ã€‚")]),s._v(" "),t("li",[t("code",[s._v("nn.Module")]),s._v(": ç¥ç»ç½‘ç»œæ¨¡å—ã€‚ å°è£…å‚æ•°çš„ä¾¿æ·æ–¹æ³•ï¼Œå¹¶å¸¦æœ‰å°†å…¶ç§»åŠ¨åˆ° "),t("code",[s._v("GPU")]),s._v("ï¼Œå¯¼å‡ºï¼ŒåŠ è½½ç­‰çš„å¸®åŠ©å™¨ã€‚")]),s._v(" "),t("li",[t("code",[s._v("nn.Parameter")]),s._v(": ä¸€ç§å¼ é‡ï¼Œå³å°†å…¶åˆ†é…ä¸º"),t("code",[s._v("Module")]),s._v("çš„å±æ€§æ—¶ï¼Œè‡ªåŠ¨æ³¨å†Œä¸ºå‚æ•°ã€‚")]),s._v(" "),t("li",[t("code",[s._v("autograd.Function")]),s._v(": å®ç°è‡ªåŠ¨å¾®åˆ†æ“ä½œçš„æ­£å‘å’Œåå‘å®šä¹‰ã€‚ æ¯ä¸ª"),t("code",[s._v("Tensor")]),s._v("æ“ä½œéƒ½ä¼šåˆ›å»ºè‡³å°‘ä¸€ä¸ª"),t("code",[s._v("Function")]),s._v("èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹è¿æ¥åˆ°åˆ›å»º"),t("code",[s._v("Tensor")]),s._v("çš„å‡½æ•°ï¼Œå¹¶ä¸”ç¼–ç å…¶å†å²è®°å½•ã€‚")])]),s._v(" "),t("h3",{attrs:{id:"æŸå¤±å‡½æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸå¤±å‡½æ•°"}},[s._v("#")]),s._v(" æŸå¤±å‡½æ•°")]),s._v(" "),t("p",[s._v("æŸå¤±å‡½æ•°é‡‡ç”¨ä¸€å¯¹ï¼ˆè¾“å‡ºï¼Œç›®æ ‡ï¼‰è¾“å…¥ï¼Œå¹¶è®¡ç®—ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼ä¼°è®¡è¾“å‡ºä¸ç›®æ ‡ä¹‹é—´çš„è·ç¦»ã€‚")]),s._v(" "),t("p",[t("code",[s._v("nn")]),s._v("åŒ…ä¸‹æœ‰å‡ ç§ä¸åŒçš„æŸå¤±å‡½æ•°ï¼Œä¸€ä¸ªç®€å•çš„æŸå¤±æ˜¯ï¼š"),t("code",[s._v("nn.MSELoss")]),s._v("ï¼Œå®ƒè®¡ç®—è¾“å…¥å’Œç›®æ ‡ä¹‹é—´çš„å‡æ–¹è¯¯å·®ï¼Œç±»ä¼¼åœ°ï¼Œè¿˜æœ‰äº¤å‰ç†µæŸå¤±"),t("code",[s._v("nn.CrossEntropyLoss")]),s._v("ï¼Œexï¼š")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("output "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# a dummy target, for example")]),s._v("\ntarget "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("view"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make it the same shape as output")]),s._v("\ncriterion "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("MSELoss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nloss "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" criterion"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("loss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\ntensor(0.3117, grad_fn=<MseLossBackward0>)\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("ç°åœ¨ï¼Œå¦‚æœä½¿ç”¨.grad_fnå±æ€§å‘åè·Ÿéšlossï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªè®¡ç®—å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("input -> conv2d -> relu -> maxpool2d -> conv2d -> relu -> maxpool2d\n      -> view -> linear -> relu -> linear -> relu -> linear\n      -> MSELoss\n      -> loss\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("å½“æˆ‘ä»¬è°ƒç”¨"),t("code",[s._v("loss.backward()")]),s._v("æ—¶ï¼Œæ•´ä¸ªå›¾å°†è¢«å¾®åˆ†ã€‚ å¹¶ä¸”å›¾ä¸­å…·æœ‰"),t("code",[s._v("requires_grad=True")]),s._v("çš„æ‰€æœ‰å¼ é‡å°†éšæ¢¯åº¦ç´¯ç§¯å…¶"),t("code",[s._v(".grad")]),s._v("å¼ é‡ã€‚")]),s._v(" "),t("p",[s._v("ä¸ºäº†è¯´æ˜ï¼Œè®©æˆ‘ä»¬å‘åèµ°å‡ æ­¥ï¼š")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("loss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad_fn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# MSELoss")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("loss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad_fn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next_functions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Linear")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("loss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad_fn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next_functions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next_functions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ReLU")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\n<MseLossBackward0 object at 0x7f71283dd048>\n<AddmmBackward0 object at 0x7f71283dd7f0>\n<AccumulateGrad object at 0x7f71283dd7f0>\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"åå‘ä¼ æ’­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åå‘ä¼ æ’­"}},[s._v("#")]),s._v(" åå‘ä¼ æ’­")]),s._v(" "),t("p",[s._v("è¦åå‘ä¼ æ’­è¯¯å·®ï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯"),t("code",[s._v("loss.backward()")]),s._v("ã€‚ ä¸è¿‡ï¼Œéœ€è¦æ¸…é™¤ç°æœ‰çš„æ¢¯åº¦ï¼Œå¦åˆ™æ¢¯åº¦å°†ç´¯ç§¯åˆ°ç°æœ‰çš„æ¢¯åº¦ä¸­ã€‚")]),s._v(" "),t("p",[s._v("exï¼šçœ‹ä¸€ä¸‹"),t("code",[s._v("backward")]),s._v("å‰å"),t("code",[s._v("conv1")]),s._v("çš„åå·®æ¢¯åº¦")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zero_grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zeroes the gradient buffers of all parameters")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'conv1.bias.grad before backward'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bias"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nloss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backward"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'conv1.bias.grad after backward'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conv1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bias"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nconv1.bias.grad before backward\nNone\nconv1.bias.grad after backward\ntensor([ 0.0125, -0.0111,  0.0211, -0.0378, -0.0042, -0.0194])\n'''")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h3",{attrs:{id:"æ›´æ–°æƒé‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°æƒé‡"}},[s._v("#")]),s._v(" æ›´æ–°æƒé‡")]),s._v(" "),t("p",[s._v("å®è·µä¸­ä½¿ç”¨çš„æœ€ç®€å•çš„æ›´æ–°è§„åˆ™æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆ"),t("code",[s._v("SGD")]),s._v("ï¼‰ï¼š")]),s._v(" "),t("p",[t("code",[s._v("weight")]),s._v(" = "),t("code",[s._v("weight")]),s._v(" - "),t("code",[s._v("learning_rate")]),s._v(" * "),t("code",[s._v("gradient")])]),s._v(" "),t("p",[s._v("ä½¿ç”¨ç¥ç»ç½‘ç»œæ—¶ï¼Œæ‚¨å¸Œæœ›ä½¿ç”¨å„ç§ä¸åŒçš„æ›´æ–°è§„åˆ™ï¼Œä¾‹å¦‚ "),t("code",[s._v("SGD")]),s._v("ï¼Œ"),t("code",[s._v("Nesterov-SGD")]),s._v("ï¼Œ"),t("code",[s._v("Adam")]),s._v("ï¼Œ"),t("code",[s._v("RMSProp")]),s._v(" ç­‰ã€‚ä¸ºå®ç°æ­¤ç›®çš„ï¼Œ"),t("code",[s._v("torch.optim")]),s._v("å¯å®ç°æ‰€æœ‰è¿™äº›æ–¹æ³•ã€‚ ä½¿ç”¨å®ƒéå¸¸ç®€å•ï¼š")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" torch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("optim "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" optim\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# create your optimizer")]),s._v("\noptimizer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" optim"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SGD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# in your training loop:")]),s._v("\noptimizer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zero_grad"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zero the gradient buffers")]),s._v("\noutput "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" net"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nloss "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" criterion"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("output"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nloss"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backward"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\noptimizer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("step"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Does the update")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("æ³¨æ„ï¼šéœ€è¦ä½¿ç”¨"),t("code",[s._v("optimizer.zero_grad()")]),s._v("å°†æ¢¯åº¦ç¼“å†²åŒºæ‰‹åŠ¨è®¾ç½®ä¸ºé›¶ã€‚ è¿™æ˜¯å› ä¸ºå¦‚åå‘ä¼ æ’­éƒ¨åˆ†ä¸­æ‰€è¿°ç´¯ç§¯äº†æ¢¯åº¦ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);